var canvas=document.getElementById("main_canvas"),ctx=canvas.getContext("2d");class Player_parent extends Observer{constructor(t){super(),this.image=new Image,this.image.src=t,this.position={x:900,y:400,width:100,height:180},this.image.onload=()=>{this.position.height=1.8*this.image.height,this.position.width=1.8*this.image.width,this.draw_player_to_canvas()},this.speed=10,this.rotation=0,this.rotationSpeed=2,this.moveInterval=null,this.rotated_position=[{top_left:null,top_right:null,bottom_left:null,bottom_right:null}],this.position_to_remove=[{x_begin:this.position.x,y_begin:this.position.y,width:this.position.width,height:this.position.height}]}change_image(t){this.image.src=t}check_collision(t){var i=calculate_new_positions([this.position.x,this.position.y,this.position.width,this.position.height,this.rotation]);this.position_to_remove.x_begin=i[4][0],this.position_to_remove.y_begin=i[4][1],this.position_to_remove.width=i[4][2],this.position_to_remove.height=i[4][3],this.rotated_position.top_left=i[0],this.rotated_position.top_right=i[1],this.rotated_position.bottom_left=i[2],this.rotated_position.bottom_right=i[3];var o,s=[],e=!1,n=!1,h=!1,_=!1,p=null,a=Number.MAX_VALUE;if(t.position.x+t.position.width>this.position_to_remove.x_begin&&t.position.x+t.position.width<this.position_to_remove.x_begin+this.position_to_remove.width?(s=this.calculate_collision_points(this.rotated_position.top_left[0],this.rotated_position.top_left[1],this.rotated_position.bottom_left[0],this.rotated_position.bottom_left[1]),e=!0):t.position.x<this.position_to_remove.x_begin+this.position_to_remove.width&&t.position.x>this.position_to_remove.x_begin&&(s=this.calculate_collision_points(this.rotated_position.top_right[0],this.rotated_position.top_right[1],this.rotated_position.bottom_right[0],this.rotated_position.bottom_right[1]),n=!0),t.position.y>this.position_to_remove.y_begin&&t.position.y<this.position_to_remove.y_begin+this.position_to_remove.height?_=!0:t.position.y+t.position.height>this.position_to_remove.y_begin&&t.position.y+t.position.height<this.position_to_remove.y_begin+this.position_to_remove.height&&(h=!0),!(1!=e&&1!=n||1!=_&&1!=h)){for(let i=0;i<s[0].length;i++)(p=1==_?s[1][i]-t.position.y:s[1][i]-t.position.y+t.position.height)<0&&(p*=-1),null==p?a=p:p<a&&(a=p,o=i);if(1==e){if(t.position.x+t.position.width-5>s[0][o])return!0}else if(1==n&&t.position.x+5<s[0][o])return!0;s=[]}}calculate_collision_points(t,i,o,s){var e=[t,o],n=[i,s];for(let t=1;t<4;t++)n.push(n[t]+(n[0]-n[t])/2),e.push(e[t]+(e[0]-e[t])/2);return n.push(n[2]+(n[3]-n[2])/2),e.push(e[2]+(e[3]-e[2])/2),n.push(n[1]+(n[0]-n[2])/2),e.push(e[1]+(e[0]-e[2])/2),n.push(n[1]+(n[0]-n[3])/2),e.push(e[1]+(e[0]-e[3])/2),n.push(n[6]+(n[0]-n[3])/2),e.push(e[6]+(e[0]-e[3])/2),[e,n]}update(t){this.check_collision(t)&&("car"==t.name?(stop_animation("lose"),play_sound("../../../static/sounds/car_crash.mp3"),increase_status(0)):"coin"==t.name?(play_sound("../../../static/sounds/coin.wav"),increase_coins(1),t.delete_object()):"boost"==t.name&&(play_sound("../../../static/sounds/coin.wav"),power_up(),t.delete_object()))}calculate_line(){let t=0,i=0;for(;this.position.x+this.position.width/2>t;)t+=166.66666666666666,i++;return i}}